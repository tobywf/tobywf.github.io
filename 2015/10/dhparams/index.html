<!DOCTYPE html><html lang="en"><head><title>How to choose Diffie-Hellman (DH) parameters - tobywf</title><meta charset="utf-8"/><meta content="Toby Fleming" name="author"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link href="//fonts.googleapis.com/css?family=Merriweather:300,300italic,700|Source+Code+Pro:400,700|Montserrat:400" rel="stylesheet" type="text/css"/><link href="/images/favicon.png" rel="icon"/><link href="/main.css" rel="stylesheet"/></head><body><div class="wrapper"><nav><ul><li><a class="cap" href="/">tobywf</a></li><li class="breadcrumb"><a href="/2015/">'15</a></li><li class="breadcrumb"><a href="/2015/10/">Oct</a></li><li class="portfolio"><a class="cap" href="/portfolio/">portfolio</a></li></ul></nav><header class="post-head"><h1>How to choose Diffie-Hellman (DH) parameters</h1><div class="infoline"><span class="date">24 Oct '15</span></div></header><article><p>The title of this post was originally “the problem with cryptography”, but that’s neither original nor helpful.</p><hr/><p>Recently, I was reviewing server provisioning scripts for best practices. One step, for a webserver, was to set up Diffie-Hellman (<span class="caps">DH</span>) parameters. Here’s the command:</p><div class="codehilite"><pre><span class="nv">$ </span>openssl dhparam -out dhparams.pem 2048
</pre></div><p>I know generating and setting the server to use the parameters is <a href="https://weakdh.org/sysadmin.html">important to avoid things like Logjam</a>, thanks to sites like <a href="https://weakdh.org/">WeakDH</a>. But I’m no cryptographer - I’m not a sysadmin either - so I don’t know why or any specifics.</p><p>For example, <span class="caps">DH</span> parameters with 1024 bits or less <a href="http://www.theregister.co.uk/2015/10/24/nsa_encryption_hack/">are discouraged since 2005</a>. But that’s a long time, are 2048 bit parameters still okay? <a href="https://weakdh.org/">WeakDH</a> and <a href="https://tools.ietf.org/html/rfc7525#section-4.4"><span class="caps">RFC</span> 7525</a> say yes. Okay then.</p><p>So are 4096 bit <span class="caps">DH</span> parameters better? I don’t know. It’s a given that it’ll take more computation time, but how much? Not being a sysadmin, I can’t test this under realistic conditions. Does it even provide more security? <a href="https://security.stackexchange.com/questions/47204/dh-parameters-recommended-size">Apparently not</a>. But I still have to trust some guy on StackExchange posting close to 2014.</p><p>Finally, I think <a href="https://crypto.stackexchange.com/questions/12223/how-should-i-manage-diffie-hellman-parameters-on-a-web-server">this StackExchange post</a> confirms that you don’t gain anything from periodically regenerating the <span class="caps">DH</span> parameters. It’s hard to tell though. From what I understand, this is because even if you capture several <span class="caps">DH</span> exchanges, this doesn’t make guessing the underlying <span class="caps">DH</span> parameters any easier than having one <span class="caps">DH</span> exchange.</p><p>So let’s recap:</p><ul><li>Use Diffie-Hellman parameters with at least 1024 bits, 2048 is better</li><li>4096 bits does nothing except generate more heat… probably</li><li>You don’t need to re-generate Diffie-Hellman parameters… probably</li><li>Cryptography is hard, so leave that to the experts</li><li>Setting up cryptography is still to hard for me (but I don’t know if that’s generalizable)</li></ul></article><section><a class="newer" href="/2015/11/distributing-python/">Newer</a> <a class="older" href="/2015/10/blog_migration/">Older</a></section><footer><p>—</p><p>Born naked, helpless, and unable to fend for himself, Toby eventually overcame these handicaps to become a code craftsman, tinkerer, and musician. Toby currently lives in England.</p><p class="cap"><span class="date">mmxii–mmxv</span> <span class="name">Toby Fleming</span></p></footer></div><script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-69823817-1', 'auto');
ga('send', 'pageview');
</script><script async="" src="//www.google-analytics.com/analytics.js"></script></body></html>